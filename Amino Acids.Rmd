---
title: "Amino Acid"
author: "Richard Edwards"
date: "June 4, 2015"
output: html_document
---



```{r}
#Amino Acids                                         NH2
 #                                                   |
 #All Amino Acids have the general composition of   HC--CO2 with the 'R' group
 #                                                   |      specifying the 
 #                                                   R      amino acid residue
 
 #Defining Aromatic 'R' Groups
 Phenyl <- c("C",rep("CH",5))
 Imidazole <- c("C","CH","NH","CH","NH+")
 Indole <- c("C","CH","NH","C","C",rep("CH",4))
 Phenol <- c("C","CH","CH","C_OH","CH","CH")
 #The following will relate the 1-letter abreviation of 
 #the 20 AA residues with their respecitve 'R' groups

A <- c("CH3")                              #Alanine (Ala)
C <- c("CH2", "SH")                        #Cysteine (Cys)
D <- c("CH2","COO-")                       #Aspartate (Asp)
E <- c("CH2","CH2","COO-")                 #Glutamate (Glu)
F <- c("CH2",Phenyl)                       #Phenylalanine (Phe)
G <- c("H")                                #Glycine (Gly)
H <- c("CH2",Imidazole)                    #Histidine (His)
I <- c("Methyl_CH","CH2","CH3")            #IsoLeucine (Ile)
K <- c(rep("CH2",4), "NH3+")               #Lysine (Lys)
L <- c("CH2","Methyl_CH","CH3")            #Leucine (Leu)
M <- c("CH2","CH2","S","CH3")              #Methionine (Met)
N <- c("CH2","CO","NH2")                   #Asparagine (Asn)
P <- c("CH2","CH2","CH2")                  #Proline (Pro)
Q <- c("CH2","CH2","CO","NH2")             #Glutamine (Gln)
R <- c(rep("CH2",3), "NH", "CNH2+","NH2")  #Arginine (Arg)
S <- c("CH2","OH")                         #Serine (Ser)
T <- c("CH2","CH3","OH")                   #Threonine (Thr)
V <- c("Methyl_CH","CH3")                  #Valine (Val)
W <- c("CH2",Indole)                       #Tryptophan (Trp)
Y <- c("CH2", Phenol)                      #Tyrosine (Tyr)
```

```{r}
#Classifying AA into groups

AAclassifier <- function(AA){
  class = list()
  n = length(AA)
  if(n <= 3){                   #classifier for Small
    class$small <- "Small"      #and Tiny AA residues
    if(n < 3){
      class$small <-"Small//Tiny"
    }
  }
  if(!is.na(match("C",AA)) == TRUE) {
    if(AA[match("C",AA):(length(Phenyl)+1)] == Phenyl ||
       AA[match("C",AA):(length(Imidazole)+1)] == Imidazole ||
       AA[match("C",AA):(length(Indole)+1)] == Indole ||
       AA[match("C",AA):(length(Phenol)+1)] == Phenol){
          
         class$aromatic <- "Aromatic"
       }

  
  
}


```

```{r}
#Acquire Mutant Frequency Table
 html("http://www.abren.net/protherm/mutation.html")%>%
+ html_node("table")%>%
+ html_table(fill=T) -> aATable


#Acquire Further Data
url <- "http://www.abren.net/protherm/protherm_result.php?&DISP01=1&DISP02=1&DISP10=1&DISP14=1&DISP16=1&DISP18=1&DISP19=1&DISP22=1&DISP23=1&DISP24=1&DISP26=1&DISP30=1&DISP31=1&DISP38=1&NUMBER2=3000000&SOURCE=human&MUTA-C0=on&ASA-C=0-Any&ASA3=0-%&PH1=6.8&PH2=8.2&COUNT_E2=980&COUNT_S2=0"

xp <- '/html/body/table[2]'

AASearch <- url %>%
  html() %>%
  html_nodes(xpath=xp)%>%
  html_table(fill=TRUE)
AASearch <- AASearch[[1]]
AASearch <- AASearch[-c(16:21)]
names(AASearch) <- c("Entry","Protein","Source","Mutation","dG_H2O","dG","T", "Tm","dHcal","m","Cm","pH","Measure","Method",	"REFERENCE")
```
